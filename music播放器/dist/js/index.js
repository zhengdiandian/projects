var controlMannager,$=window.Zepto,root=window.player,$scope=$("body"),songList={},audio=new root.audioManager;function bindTouck(){var o=$scope.find(".slider-point"),n=$scope.find(".pro-wrapper").offset(),a=n.left,r=n.width;o.on("touchstart",function(){root.progress.stop()}).on("touchmove",function(o){var n=(o.changedTouches[0].clientX-a)/r;(n<0||1<n)&&(n=0),root.progress.upData(n)}).on("touchend",function(o){var n=(o.changedTouches[0].clientX-a)/r;(n<0||1<n)&&(n=0);var t=songList[controlMannager.index].duration*n;audio.jumpToplay(t),"play"===audio.status&&root.progress.start(n)})}function bindEvent(){$scope.on("play:change",function(o,n,t){root.progress.renderAllTime(songList[n].duration),root.render(songList[n]),audio.setAudioSouce(songList[n].audio),"play"!==audio.status&&!0!==t||(audio.audio.play(),root.progress.start()),root.progress.upData(0)}),$scope.on("click",".prev-btn",function(){var o=controlMannager.prev();$scope.trigger("play:change",o)}),$scope.on("click",".next-btn",function(){var o=controlMannager.next();$scope.trigger("play:change",o)}),$scope.on("click",".play-btn",function(){"play"===audio.status?($(this).toggleClass("playing"),audio.pause(),root.progress.stop()):($(this).toggleClass("playing"),audio.play(),root.progress.start())}),$scope.on("click",".close-btn",function(){root.playList.show(controlMannager)}),$scope.on("click",".list-btn",function(){root.playList.show(controlMannager)})}function getData(o){$.ajax({type:"GET",url:o,success:function(o){controlMannager=new root.ControlMannager(o.length),songList=o,root.playList.renderList(o),bindTouck(),bindEvent(),root.playList.bindEvent(),$scope.trigger("play:change",0)},error:function(){}})}getData("../mock/data.json");